# 表白分墙

## 项目搭建

>技术栈：
>
>- java版本：8
>- 框架：springboot-.7.3+mybatis-plus-3.4.3
>- 数据库：mysql-5.7   看情况redis <下面没有依赖>

pom文件：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.14</version>
        <relativePath/> <!-- lookup parent from repository -->
    </parent>
    <groupId>com.wall</groupId>
    <artifactId>loveWall</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>loveWall</name>
    <description>loveWall</description>
    <properties>
        <java.version>1.8</java.version>
        <spring-boot.version>2.7.14</spring-boot.version>
        <mybatis-plus.version>3.4.3</mybatis-plus.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.49</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <!-- MyBatis Plus -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>${mybatis-plus.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project>
```

## 需求

1. 用户可以设置学校，(通过实时定位获取位置里面的学校)，手动输入学校进行切换

2. 查看学校表白墙详情功能

3. 对表白墙上发布的内容进行评价，并做记录

4. 对学校的申请，管理员来审核他是否通过

5. 发布表白墙的接口

6. 对于本校的表白墙发布，由本校的管理员来审核(超级管理员指定)


## 表设计

```mysql
-- 用户表（User）
CREATE TABLE User (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '用户ID',
Username VARCHAR(255) NOT NULL COMMENT '用户名',
SchoolId INT COMMENT '学校ID',
WechatId VARCHAR(255) NOT NULL COMMENT '微信ID',
CreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
WXAccount VARCHAR(255) COMMENT '微信账号',
Gender TINYINT(1) DEFAULT NULL COMMENT '性别，0表示女性，1表示男性，NULL表示未知',
AvatarURL VARCHAR(255) COMMENT '头像地址'
);

-- 学校表（School）
CREATE TABLE School (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '学校ID',
SchoolName VARCHAR(255) NOT NULL COMMENT '学校名称',
AvatarURL VARCHAR(255) COMMENT '头像地址',
Description TEXT COMMENT '描述内容',
CreatorId INT COMMENT '创建者ID',
CreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
);

-- 表白墙表（ConfessionWall）
CREATE TABLE ConfessionWall (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '表白墙ID',
SchoolId INT COMMENT '学校ID',
CreatorUserId INT COMMENT '创建者用户ID',
AvatarURL VARCHAR(255) COMMENT '头像地址',
WallName VARCHAR(255) COMMENT '表白墙名字',
Description VARCHAR(255) NOT NULL COMMENT '表白墙描述',
CreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
Status TINYINT COMMENT '状态，0表示正常，1表示被禁用',
FOREIGN KEY (SchoolId) REFERENCES School(Id),
FOREIGN KEY (CreatorUserId) REFERENCES User(Id)
);

-- 表白墙发布内容表——要管理员审核（ConfessionPostReview）  审核完之后就会在发布内容里面
CREATE TABLE ConfessionPostReview (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '审核记录ID',
PostIds JSON COMMENT '发布内容ID列表',
ReviewerId INT COMMENT '审核人ID',
ReviewStatus ENUM('Pending', 'Approved', 'Rejected') COMMENT '审核状态',
ReviewTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '审核时间',
FOREIGN KEY (ReviewerId) REFERENCES User(Id)
);

-- 表白墙发布内容表（ConfessionPost）
CREATE TABLE ConfessionPost (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '发布内容ID',
WallId INT COMMENT '所属表白墙ID',
UserId INT COMMENT '发布者用户ID',
TextContent TEXT COMMENT '发布内容文字',
ImageURL VARCHAR(255) COMMENT '发布内容图片URL',
CreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
IsDeleted BOOLEAN DEFAULT FALSE COMMENT '逻辑删除标志',
FOREIGN KEY (WallId) REFERENCES ConfessionWall(Id),
FOREIGN KEY (UserId) REFERENCES User(Id)
);


-- 评论表（Comment）
CREATE TABLE Comment (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '评论记录ID',
ConfessionPostReviewId INT COMMENT '关联的表白墙发布内容审核表ID',
UserId INT COMMENT '用户ID',
CommentContent TEXT COMMENT '评论内容',
CommentTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '评论时间',
IsDeleted BOOLEAN DEFAULT FALSE COMMENT '逻辑删除标志',
FOREIGN KEY (ConfessionPostReviewId) REFERENCES ConfessionPostReview(Id),
FOREIGN KEY (UserId) REFERENCES User(Id)
);

-- 管理员表（Admin）
CREATE TABLE Admin (
Id INT PRIMARY KEY AUTO_INCREMENT COMMENT '管理员ID',
SchoolId INT COMMENT '学校ID',
UserId INT COMMENT '用户ID',
PhoneNumber VARCHAR(20) COMMENT '手机号',
WeChatId VARCHAR(50) COMMENT '微信号',
CreateTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
);
```

## 需求分解

1. 用户设置学校：
   - 提供实时定位功能，获取用户所在位置的学校信息。
   - 用户可以手动输入学校名称进行切换。
   - 在用户表（User）中添加字段SchoolId，用于记录用户所在的学校ID。
2. 查看学校表白墙详情功能：
   - 提供接口或页面，展示指定学校的表白墙详情信息。
   - 根据学校ID查询表白墙表（ConfessionWall），获取该学校的表白墙信息。
3. 对表白墙上发布的内容进行评价，并做记录：
   - 提供评论功能，用户可以对表白墙上的发布内容进行评价。
   - 在评论表（Comment）中记录评论内容、评论时间等信息。
   - 通过关联表（ConfessionPostReview）和表白墙发布内容表（ConfessionPost）的ID，将评论与对应的发布内容关联起来。
4. 对学校的申请进行审核：
   - 提供学校申请接口或页面，让用户提交学校申请信息。
   - 在管理员表（Admin）中添加字段ReviewStatus，表示审核状态，包括待审核、已通过、已拒绝。
   - 管理员可以查看学校申请列表，并进行审核操作，更新审核状态。
5. 发布表白墙的接口：
   - 提供接口或页面，让用户发布表白墙。
   - 在表白墙表（ConfessionWall）中插入一条新的记录，包括学校ID、创建者用户ID、表白墙名字、描述等信息。
6. 本校表白墙发布由管理员审核：
   - 超级管理员指定本校管理员。
   - 在管理员表（Admin）中添加字段IsSuperAdmin，表示是否为超级管理员。
   - 只有本校管理员才有权限审核本校的表白墙发布内容。
   - 在表白墙发布内容表（ConfessionPost）中添加字段IsDeleted，表示逻辑删除标志，在管理员审核通过后可以将发布内容标记为已删除。







